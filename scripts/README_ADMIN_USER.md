# Admin User Creation Scripts

This directory contains scripts to create admin users for the PanelMerge application.

## Files

- `create_admin_user.ps1` - PowerShell wrapper script (Windows)
- `db/create_admin_user.py` - Main Python script for creating admin users

## Usage

### Option 1: PowerShell Script (Recommended for Windows)

#### Interactive Mode (Default)
```powershell
.\create_admin_user.ps1
```
This will prompt you for all required information.

#### With Parameters
```powershell
.\create_admin_user.ps1 -Username "admin" -Email "admin@example.com"
```

#### Non-Interactive Mode
```powershell
.\create_admin_user.ps1 -Username "admin" -Email "admin@example.com" -Password "SecurePassword123" -NonInteractive
```

#### All Parameters
```powershell
.\create_admin_user.ps1 -Username "admin" -Email "admin@example.com" -Password "SecurePassword123" -FirstName "John" -LastName "Doe" -Organization "My Company" -NonInteractive
```

### Option 2: Direct Python Script

#### Interactive Mode
```bash
python scripts/db/create_admin_user.py
```

#### With Command Line Arguments
```bash
python scripts/db/create_admin_user.py -u admin -e admin@example.com
```

#### Non-Interactive Mode
```bash
python scripts/db/create_admin_user.py -u admin -e admin@example.com -p SecurePassword123 --non-interactive
```

## Command Line Arguments

| Argument | Short | Description |
|----------|-------|-------------|
| `--username` | `-u` | Username for the admin user |
| `--email` | `-e` | Email address for the admin user |
| `--password` | `-p` | Password (not recommended for security) |
| `--first-name` | `-f` | First name (optional) |
| `--last-name` | `-l` | Last name (optional) |
| `--organization` | `-o` | Organization name (optional) |
| `--non-interactive` | | Run without prompts (requires username, email, password) |

## Security Notes

- **Avoid using `-p/--password` parameter** in production as it may be visible in command history
- In interactive mode, passwords are entered securely using `getpass` (no echo)
- The script will check for existing users with the same username or email
- Admin users are created with:
  - Role: ADMIN
  - Active: True
  - Verified: True
  - Failed login attempts: 0

## Prerequisites

1. Python 3.x installed and accessible via command line
2. Virtual environment activated (if using one)
3. All required Python packages installed (`pip install -r requirements.txt`)
4. Database configuration properly set up

## Examples

### Create admin user interactively
```powershell
.\create_admin_user.ps1
```

### Create admin user with minimal info
```powershell
.\create_admin_user.ps1 -Username "sysadmin" -Email "sysadmin@company.com"
```

### Create admin user in automation script
```powershell
.\create_admin_user.ps1 -Username "auto_admin" -Email "auto@company.com" -Password "AutoGeneratedPassword123!" -NonInteractive
```

## Troubleshooting

### Python not found
- Ensure Python is installed and in your PATH
- Try using `python3` instead of `python`
- On Windows, try using `py` command

### Database connection errors
- Check database configuration in `app/config_settings.py`
- Ensure database server is running
- Verify connection credentials

### Permission errors
- Run PowerShell as Administrator if needed
- Check file permissions in the project directory

### Import errors
- Ensure you're running from the project root directory
- Verify all dependencies are installed: `pip install -r requirements.txt`
- Check that virtual environment is activated if using one

## Security Best Practices

1. **Strong Passwords**: Use complex passwords with mixed case, numbers, and symbols
2. **Unique Credentials**: Don't reuse passwords from other systems
3. **Secure Storage**: Store admin credentials securely
4. **Regular Updates**: Change admin passwords regularly
5. **Audit Trail**: Monitor admin user activity through the application's audit system
